# Segmentation + SAM

This source represent an alternative to the sources described in the paper `Improving Existing Segmentators Performance with Zero-Shot Segmentators`. They aim to perform the inference of SAM based on a previously generated segmentation mask and fuse both of them in order to achieve the final prediction.

## 1. Inference (`scripts/seg_n_sam/inference.py`)
Script responsible for generating the segmentation maps using SAM or SAMUS. Before running it, please update the configuration file (`scripts/seg_n_sam/config/inference.py`).

This script automatically generates the point prompts using one of the sampler approaches defined in our previous work. It is important to mention that such prompts are generated from the masks obtained by a third model (in our case, DeepLabV3+) and not from the ground truth themselves.

The generated outputs are the results binary mask (`{image_name}.png`) and the non-normalized logits (`low_{imag_name}.npy`).

## 2. Evaluation and Fusion (`scripts/seg_n_sam/eval.py`)
In this script, we take the outputs generated by the inference script, the input images and the ground truth masks to evaluate the overall performance obtained by using SAM. The evaluation metrics generated are: Intersection Over Union (IOU), Dice, Mean Absolute Error (MAE), F-Measure and E-Measure.

Also, this script applies the fusion method described in our previous paper, as well as the ones described on the paper "[On Combining Classifiers](https://doi.org/10.1109/34.667881)". All of the generated outputs from this script may be found in the attribute `ExperimentConfig.BASE_OUTPUT_PATH`.
